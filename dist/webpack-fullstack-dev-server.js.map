{"version":3,"sources":["webpack:///webpack/bootstrap a52f50726980a8e4fa48","webpack:///external \"path\"","webpack:///external \"webpack\"","webpack:///external \"fs\"","webpack:///./src/index.ts","webpack:///./src/process-config.ts","webpack:///external \"child_process\"","webpack:///external \"memory-fs\"","webpack:///./src/webpack-fullstack-dev-server.ts"],"names":[],"mappings":"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","file":"webpack-fullstack-dev-server.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 8);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap a52f50726980a8e4fa48","module.exports = require(\"path\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"path\"\n// module id = 0\n// module chunks = 0 1","module.exports = require(\"webpack\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"webpack\"\n// module id = 1\n// module chunks = 0 1","module.exports = require(\"fs\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"fs\"\n// module id = 2\n// module chunks = 0 1","/// <reference path=\"./index.d.ts\" />\n\nimport * as path from 'path';\nimport * as fs from 'fs';\nimport * as webpack from 'webpack';\nimport * as MemoryFS from 'memory-fs';\nimport * as childProcess from 'child_process';\nimport {WFSConfigInterface} from './index.d';\nimport processConfig from './process-config';\n\ndeclare const __non_webpack_require__: (path: string) => any;\nconst userDir = path.resolve( process.cwd() );\nconst userConfigPath = path.join( userDir, 'webpack.fullstack.js' );\nconst userConfig = __non_webpack_require__( userConfigPath );\nconst processedConfig = processConfig( userConfig, userDir );\nconst opts = {\n  outputClient: process.argv[2] === '--output-client' ? true : false\n};\n\nexport {\n  opts,\n  userDir,\n  userConfigPath,\n  userConfig,\n  processedConfig\n};\n\n\n\n// WEBPACK FOOTER //\n// ./~/eslint-loader!./src/index.ts","import * as fs from 'fs';\nimport * as path from 'path';\nimport * as webpack from 'webpack';\nimport {WFSConfigInterface} from './index.d';\n\nvar serverDefaults = {\n  target: 'node',\n  node: {\n    __dirname: true\n  },\n  externals : {},\n  plugins: [\n    new webpack.BannerPlugin({\n      banner: 'require(\"source-map-support\").install();',\n      raw: true,\n      entryOnly: true\n    })\n  ]\n};\n\nvar clientDefaults = {\n\n};\n\nfunction processConfig(\n  config: WFSConfigInterface,\n  devDir: string\n): any {\n\n  fs.readdirSync( path.resolve(devDir, 'node_modules') )\n    .filter( (x) => ['.bin'].indexOf(x) === -1 )\n    .forEach( (m) => serverDefaults.externals[m] = 'commonjs ' + m );\n\n  serverDefaults.externals['react-dom/server'] = 'commonjs react-dom/server';\n  serverDefaults.externals['history/createBrowserHistory'] = 'commonjs history/createBrowserHistory';\n\n  for (let key in config) {\n    if (key === 'server') {\n      config.server = {\n        ...serverDefaults,\n        ...config.server,\n        devtool: 'source-map'\n      };\n\n    } else if (key === 'client') {\n      config.client = {\n        ...clientDefaults,\n        ...config.client\n      };\n\n    } else {\n      config.server[key] = config[key];\n      config.client[key] = config[key];\n    }\n  }\n\n  return config;\n};\n\nexport default processConfig;\n\n\n\n// WEBPACK FOOTER //\n// ./~/eslint-loader!./src/process-config.ts","module.exports = require(\"child_process\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"child_process\"\n// module id = 5\n// module chunks = 0","module.exports = require(\"memory-fs\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"memory-fs\"\n// module id = 6\n// module chunks = 0","import * as path from 'path';\nimport * as fs from 'fs';\nimport * as webpack from 'webpack';\nimport * as MemoryFS from 'memory-fs';\nimport * as childProcess from 'child_process';\nimport {WFSConfigInterface} from './index.d';\nimport processConfig from './process-config';\n\nimport {\n  opts,\n  userDir,\n  userConfigPath,\n  userConfig,\n  processedConfig,\n} from './index';\n\nif (opts.outputClient) {\n  fs.writeFile(\n    path.resolve(userDir, 'node_modules/webpack-fullstack/dist/webpack.client.config.js'),\n    `\n      // encode regex values as strings\n      const configAsString = '${JSON.stringify(processedConfig.client, (key, val) =>\n        val instanceof RegExp ? '_PxEgEr_' + val.toString().slice(2) : val )}';\n\n      // decode strings into regex values\n      module.exports = JSON.parse(configAsString, (key, val) =>\n        typeof val === 'string' && val.substring(0, 8) === '_PxEgEr_' ? new RegExp( '${String.raw`\\\\`}' + val.slice(8, -1)) : val);\n    `,\n    () => console.log('webpack client config created.')\n  );\n}\n\nlet serverCompiler = webpack( processedConfig.server );\nconst mfs = new MemoryFS();\n\nserverCompiler.outputFileSystem = mfs;\nlet serverProcess;\n\nconsole.log('webpack server is compiling and watching for changes...');\n\nserverCompiler.watch({\n  // TODO: modify ignored to include all client files, but no server files\n  // ignored: userConfig.client.entry.slice( 0, userConfig.client.entry.lastIndexOf('/') )\n}, function startAppServer( err, stats: any ) {\n  if (err) {\n    console.log('webpack server failed.');\n    return console.log(err);\n  }\n\n  console.log('webpack server compiled succesfully.');\n\n  if (serverProcess) {\n    serverProcess.kill();\n  }\n\n  const serverScriptPath = stats.compilation.assets['server.bundle.js'].existsAt;\n  const serverScript = mfs.readFileSync(serverScriptPath);\n  const vmPath = path.resolve(userDir, 'node_modules/webpack-fullstack/dist/vm.js');\n  const serverEntryPath = path.resolve(userDir, 'src/server.ts');\n\n  serverProcess = childProcess.spawn('node', [\n    vmPath,\n    serverScript,\n    serverEntryPath\n  ]);\n\n  serverProcess.stdout.on('data', (data) => {\n    console.log(data.toString());\n  });\n\n  serverProcess.stderr.on('data', (data) => {\n    console.log(data.toString());\n  });\n\n  serverProcess.on('exit', (code) => {\n    console.log(`Child exited with code ${code}`);\n  });\n});\n\n\n\n// WEBPACK FOOTER //\n// ./~/eslint-loader!./src/webpack-fullstack-dev-server.ts"],"sourceRoot":""}